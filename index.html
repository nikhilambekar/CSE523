<!DOCTYPE html>
<html>

<head>
<meta charset='utf-8'>
<meta http-equiv="X-UA-Compatible" content="chrome=1">
<meta name="description"
	content="Cse523 : Network Analytics Visulaizations">

<link rel="stylesheet" type="text/css" media="screen"
	href="stylesheets/stylesheet.css">

<title>Cse523</title>

<style>
#map-canvas {
	height: 700px;
	width: 1024px;
	margin-left: auto;
	margin-right: auto;
	border: 1px solid #ccc;
	background-color: #f3f3f3;
}

#chart1 {
	height: 500px;
	width: 1100px;
	margin-left: auto;
	margin-right: auto;
}

.centerDiv {
	display: table;
	margin-left: auto;
	margin-right: auto;
	margin-top:20px;
	margin-bottom:20px;
}

.map {
	background: #fff;
	padding: 15px;
	box-shadow: 0 0 20px #999;
	border-radius: 2px;
}
</style>

<link href="stylesheets/nv.d3.css" rel="stylesheet">
<script type="text/javascript" src="javascripts/jquery-1.11.2.min.js"></script>
<script type="text/javascript" src="javascripts/jquery.sparkline.min.js"></script>
<script type="text/javascript" src="javascripts/jquery.outerhtml.js"></script>
<script type="text/javascript" src="javascripts/papaparse.js"></script>
<script type="text/javascript"
	src="javascripts/markerclusterer_compiled.js"></script>
<script src="http://d3js.org/d3.v3.min.js"></script>
<script type="text/javascript" src="javascripts/stream_layers.js"></script>
<script type="text/javascript" src="javascripts/nv.d3.js"></script>
<script src="http://code.highcharts.com/highcharts.js"></script>
<script src="http://code.highcharts.com/modules/exporting.js"></script>
<script type="text/javascript">
	$(function() {
		/** This code runs when everything has been loaded on the page */
		/* Inline sparklines take their values from the contents of the tag */
		$('.inlinesparkline').sparkline();

		/* Sparklines can also take their values from the first argument 
		passed to the sparkline() function */
		var myvalues = [ 10, 8, 5, 7, 4, 4, 1, 4, 4, 7, 5, 9, 10 ];
		$('.dynamicsparkline').sparkline(myvalues);

		/* The second argument gives options such as chart type */
		$('.dynamicbar').sparkline(myvalues, {
			type : 'bar',
			barColor : 'green'
		});

		/* Use 'html' instead of an array of values to pass options 
		to a sparkline with data in the tag */
		$('.inlinebar').sparkline('html', {
			type : 'bar',
			barColor : 'red'
		});
	});
</script>

<script>
	function getAddress(lat, longitude) {
		var geocodingAPI = "http://maps.googleapis.com/maps/api/geocode/json?latlng="
				+ lat + "," + longitude + "&sensor=true";
		var address = null;

		$.ajax({
			url : geocodingAPI,
			async : false,
			dataType : 'json',
			success : function(json) {
				try {
					address = json.results[0].formatted_address;
				} catch (err) {
					address = "";
					console.log(err.message);
				}

			}
		});
		return address;
	}
</script>

<script
	src="https://maps.googleapis.com/maps/api/js?v=3.exp&signed_in=true&libraries=visualization"></script>

</head>

<body>

	<!-- HEADER -->
	<div id="header_wrap" class="outer">
		<header class="inner">
			<a id="forkme_banner" href="https://github.com/nikhilambekar/CSE523">View
				on GitHub</a>

			<h1 id="project_title">Cse523</h1>
			<h2 id="project_tagline">Network Analytics Visulaizations</h2>
		</header>
	</div>

	<!-- MAIN CONTENT -->
	<div id="main_content_wrap" class="outer">
		<section id="main_content" class="inner">
			<div id="sparklines" class="centerDiv">
				<span class="inlinesparkline">1,4,4,7,5,9,10,4,4,7,5,9,10,4,4,7,5,9,10</span>
				<span class="dynamicsparkline">Loading..</span> <span
					class="dynamicbar">Loading..</span> <span class="inlinebar">1,3,4,5,3,5,4,4,7,5,9,10,4,4,7,5,9,10</span>
			</div>
			<div id='chart1'>
				<svg style='height: 500px; width: 1100px;'> </svg>
			</div>
			<script src='javascripts/multiBar.js' type='text/javascript'>
				
			</script>
			<div id='map'>
				<div id='map-canvas'></div>
			</div>
			<script type="text/javascript">
				var map, heatmap;
				var pointArray = [ [] ];
				var taxiData = new Array();
				function doStuff(data, loadMap) {
					pointArray = data.slice();

					loadMap();
				}

				function parseData(url, callBack) {
					Papa.parse(url, {
						download : true,
						dynamicTyping : true,
						complete : function(results) {
							callBack(results.data, loadMap);
						}
					});
				}

				function Create2DArray(rows) {
					var arr = [];

					for (var i = 0; i < rows; i++) {
						arr[i] = [];
					}

					return arr;
				}
				parseData("data/lat-longitude.csv", doStuff);
				function initialize() {

					var mapOptions = {
						zoom : 2,
						center : new google.maps.LatLng(40.764213, 0.00196),
						//tileSize : new google.maps.Size(256, 256),
						rotateControl : false,
						scrollwheel : false,styles : [ {
							"featureType" : "road",
							"elementType" : "geometry",
							"stylers" : [ {
								"visibility" : "off"
							} ]
						}, {
							"featureType" : "poi",
							"elementType" : "all",
							"stylers" : [ {
								"visibility" : "off"
							} ]
						}, {
							"featureType" : "poi.park",
							"elementType" : "geometry.fill",
							"stylers" : [ {
								"visibility" : "off"
							} ]
						}, {
							"featureType" : "landscape",
							"elementType" : "geometry",
							"stylers" : [ {
								"color" : "#fffffa"
							} ]
						}, {
							"featureType" : "water",
							"elementType" : "labels",
							"stylers" : [ {
								"visibility" : "off"
							} ]
						}, {
							"featureType" : "road",
							"elementType" : "labels",
							"stylers" : [ {
								"visibility" : "off"
							} ]
						}, {
							"featureType" : "transit",
							"stylers" : [ {
								"visibility" : "off"
							} ]
						}, {
							"featureType" : "administrative.country",
							"elementType" : "all",
							"stylers" : [ {
								"visibility" : "simplified"
							} ]
						}, {
							"featureType" : "administrative.province",
							"elementType" : "all",
							"stylers" : [ {
								"visibility" : "simplified"
							} ]
						}, {
							"featureType" : "administrative.locality",
							"elementType" : "all",
							"stylers" : [ {
								"visibility" : "off"
							} ]
						}, {
							"featureType" : "administrative.neighborhood",
							"elementType" : "all",
							"stylers" : [ {
								"visibility" : "off"
							} ]
						}, {
							"featureType" : "administrative.land_parcel",
							"elementType" : "all",
							"stylers" : [ {
								"visibility" : "off"
							} ]
						} ]
					
					};

					map = new google.maps.Map(document
							.getElementById('map-canvas'), mapOptions);
					for (var i = 0; i < pointArray.length; i++) {
						// Create a lat/long object readable by Google

						var marker = new google.maps.Marker({
							position : new google.maps.LatLng(
									parseFloat(pointArray[i][1]),
									parseFloat(pointArray[i][2])),
							map : map,
							title : title : "IP : "+pointArray[i][0] + "</br>"
							+ "Location : "+getAddress(pointArray[i][1], pointArray[i][2])
						});
						(function(marker, i) {
							// add click event
							google.maps.event
									.addListener(
											marker,
											'click',
											function() {
												infowindow = new google.maps.InfoWindow(
														{
															content : marker.title
														});
												infowindow.open(map, marker);
											});
						})(marker, i);
						taxiData.push(marker);
					}
					var markerCluster = new MarkerClusterer(map, taxiData);

					}

				function loadMap() {
					/* google.maps.event.addDomListener(window, 'load', initialize); */
					initialize();
				}
			</script>
			<div id="scatter" class="centerDiv" ></div>
			<script src="javascripts/punchcard.js"></script>
			
			<div id="containerHigh" style="width: 800px; height: 400px; margin: 0 auto"></div>
			<script type="text/javascript">
$(function () {
    var chart;
    $(document).ready(function() {
    
        var colors = Highcharts.getOptions().colors,
            categories = ['192.168.0.1', '192.168.0.2', '192.168.0.3', '192.168.0.4', '192.168.0.5'],
            name = 'Source IP',
            data = [{
                    y: 291,
                    color: colors[0],
                    drilldown: {
                        name: '192.168.0.1',
                        categories: ['80', '443', '5050', '1755'],
                        data: [26, 91, 46, 128],
                        color: colors[0]
                    }
                }, {
                    y: 494,
                    color: colors[1],
                    drilldown: {
                        name: '192.168.0.2',
                        categories: ['80', '443', '5050', '1755'],
                        data: [48, 75, 148, 223],
                        color: colors[1]
                    }
                }, {
                    y: 188,
                    color: colors[2],
                    drilldown: {
                        name: '192.168.0.3',
                        categories: ['80', '443', '5050', '1755'],
                        data: [98, 12, 55, 23],
                        color: colors[2]
                    }
                }, {
                    y: 1379,
                    color: colors[3],
                    drilldown: {
                        name: '192.168.0.4',
                        categories: ['80', '443', '5050', '1755'],
                        data: [128, 248, 547, 456],
                        color: colors[3]
                    }
                }, {
                    y: 578,
                    color: colors[4],
                    drilldown: {
                        name: '192.168.0.5',
                        categories:['80', '443', '5050', '1755'],
                        data: [ 147, 128, 178, 125],
                        color: colors[4]
                    }
                }]
            ;
    
        function setChart(name, categories, data, color) {
			chart.xAxis[0].setCategories(categories, false);
			chart.series[0].remove(false);
			chart.addSeries({
				name: name,
				data: data,
			}, false);
			chart.redraw();
        }
    
        chart = new Highcharts.Chart({
            chart: {
                renderTo: 'containerHigh',
                type: 'line'
            },
            title: {
                text: 'Ip Traffic Analysis'
            },
            legend:{
                enabled:false
            },
            xAxis: {
                categories: categories
            },
            yAxis: {
                title: {
                    text: 'Count'
                }
            },
            plotOptions: {
                line: {
                    cursor: 'pointer',
                    point: {
                        events: {
                            click: function() {
                                var drilldown = this.drilldown;
                                if (drilldown) { // drill down
                                    setChart(drilldown.name, drilldown.categories, drilldown.data, drilldown.color);
                                } else { // restore
                                    setChart(name, categories, data);
                                }
                            }
                        }
                    },
                    dataLabels: {
                        enabled: true,
                        color: colors[1],/* ,
                        style: {
                            fontWeight: 'bold'
                        }, */
                        formatter: function() {
                            return this.y +' Packets';
                        }
                    }
                }
            },
            tooltip: {
                formatter: function() {
                    var point = this.point,
                        s = this.x +':<b>'+ this.y +' packets';
                    if (point.drilldown) {
                        s += '<br>Click to view '+ point.category +' detailed port details';
                    } else {
                        s += '<br>Click to return to IP Address';
                    }
                    return s;
                }
            },
            series: [{
                name: name,
                data: data
            }],
            exporting: {
                enabled: false
            }
        });
    });
    
});
</script>
		</section>
	</div>

	<!-- FOOTER  -->
	<div id="footer_wrap" class="outer">
		<footer class="inner">
			<p class="copyright">
				Cse523 maintained by <a href="https://github.com/nikhilambekar">nikhilambekar</a>
			</p>
			<p>
				Published with <a href="https://pages.github.com">GitHub Pages</a>
			</p>
		</footer>
	</div>



</body>
</html>
