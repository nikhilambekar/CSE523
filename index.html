<!DOCTYPE html>
<html>

<head>
<meta charset='utf-8'>
<meta http-equiv="X-UA-Compatible" content="chrome=1">
<meta name="description"
	content="Cse523 : Network Analytics Visulaizations">

<link rel="stylesheet" type="text/css" media="screen"
	href="stylesheets/stylesheet.css">

<title>Cse523</title>

<style>
#map-canvas {
	height: 700px;
	width: 1024px;
	margin-left: auto;
	margin-right: auto;
	border: 1px solid #ccc;
	background-color: #f3f3f3;
}

#chart1 {
	height: 500px;
	width: 1100px;
	margin-left: auto;
	margin-right: auto;
}

.centerDiv {
	display: table;
	margin-left: auto;
	margin-right: auto;
	margin-top: 20px;
	margin-bottom: 20px;
	height: 300px;
}

.map {
	background: #fff;
	padding: 15px;
	box-shadow: 0 0 20px #999;
	border-radius: 2px;
}
</style>

<link href="stylesheets/nv.d3.css" rel="stylesheet">
<script type="text/javascript" src="javascripts/jquery-1.11.2.min.js"></script>
<script type="text/javascript" src="javascripts/jquery.sparkline.min.js"></script>
<script type="text/javascript" src="javascripts/jquery.outerhtml.js"></script>
<script type="text/javascript" src="javascripts/papaparse.js"></script>
<script type="text/javascript"
	src="javascripts/markerclusterer_compiled.js"></script>
<script src="http://d3js.org/d3.v3.min.js"></script>
<script type="text/javascript" src="javascripts/stream_layers.js"></script>
<script type="text/javascript" src="javascripts/nv.d3.js"></script>
<script src="http://code.highcharts.com/highcharts.js"></script>
<script src="http://code.highcharts.com/highcharts-3d.js"></script>
<script src="http://code.highcharts.com/modules/exporting.js"></script>
<script type="text/javascript">
	$(function() {
		/** This code runs when everything has been loaded on the page */
		/* Inline sparklines take their values from the contents of the tag */
		$('.inlinesparkline').sparkline();

		/* Sparklines can also take their values from the first argument 
		passed to the sparkline() function */
		var myvalues = [ 10, 8, 5, 7, 4, 4, 1, 4, 4, 7, 5, 9, 10 ];
		$('.dynamicsparkline').sparkline(myvalues);

		/* The second argument gives options such as chart type */
		$('.dynamicbar').sparkline(myvalues, {
			type : 'bar',
			barColor : 'green'
		});

		/* Use 'html' instead of an array of values to pass options 
		to a sparkline with data in the tag */
		$('.inlinebar').sparkline('html', {
			type : 'bar',
			barColor : 'red'
		});
	});
</script>

<script>
	function getAddress(lat, longitude) {
		var geocodingAPI = "http://maps.googleapis.com/maps/api/geocode/json?latlng="
				+ lat + "," + longitude + "&sensor=true";
		var address = null;

		$.ajax({
			url : geocodingAPI,
			async : false,
			dataType : 'json',
			success : function(json) {
				try {
					address = json.results[0].formatted_address;
				} catch (err) {
					address = "";
					console.log(err.message);
				}

			}
		});
		return address;
	}
</script>

<script
	src="https://maps.googleapis.com/maps/api/js?v=3.exp&signed_in=true&libraries=visualization"></script>

</head>

<body>

	<!-- HEADER -->
	<div id="header_wrap" class="outer">
		<header class="inner">
			<a id="forkme_banner" href="https://github.com/nikhilambekar/CSE523">View
				on GitHub</a>

			<h1 id="project_title">Cse523</h1>
			<h2 id="project_tagline">Network Analytics Visulaizations</h2>
		</header>
	</div>

	<!-- MAIN CONTENT -->
	<div id="main_content_wrap" class="outer">
		<section id="main_content" class="inner">
			<div id="sparklines" class="centerDiv">
				<span class="inlinesparkline">1,4,4,7,5,9,10,4,4,7,5,9,10,4,4,7,5,9,10</span>
				<span class="dynamicsparkline">Loading..</span> <span
					class="dynamicbar">Loading..</span> <span class="inlinebar">1,3,4,5,3,5,4,4,7,5,9,10,4,4,7,5,9,10</span>
			</div>
			<div id='chart1'>
				<svg style='height: 500px; width: 1100px;'> </svg>
			</div>
			<script src='javascripts/multiBar.js' type='text/javascript'>
				
			</script>
			<div id='map'>
				<div id='map-canvas'></div>
			</div>
			<script type="text/javascript">
				var map, heatmap;
				var pointArray = [ [] ];
				var taxiData = new Array();
				function doStuff(data, loadMap) {
					pointArray = data.slice();

					loadMap();
				}

				function parseData(url, callBack) {
					Papa.parse(url, {
						download : true,
						dynamicTyping : true,
						complete : function(results) {
							callBack(results.data, loadMap);
						}
					});
				}

				function Create2DArray(rows) {
					var arr = [];

					for (var i = 0; i < rows; i++) {
						arr[i] = [];
					}

					return arr;
				}
				parseData("data/lat-longitude.csv", doStuff);
				function initialize() {

					var mapOptions = {
						zoom : 2,
						center : new google.maps.LatLng(40.764213, 0.00196),
						//tileSize : new google.maps.Size(256, 256),
						rotateControl : false,
						scrollwheel : false,
						styles : [ {
							"featureType" : "road",
							"elementType" : "geometry",
							"stylers" : [ {
								"visibility" : "off"
							} ]
						}, {
							"featureType" : "poi",
							"elementType" : "all",
							"stylers" : [ {
								"visibility" : "off"
							} ]
						}, {
							"featureType" : "poi.park",
							"elementType" : "geometry.fill",
							"stylers" : [ {
								"visibility" : "off"
							} ]
						}, {
							"featureType" : "landscape",
							"elementType" : "geometry",
							"stylers" : [ {
								"color" : "#fffffa"
							} ]
						}, {
							"featureType" : "water",
							"elementType" : "labels",
							"stylers" : [ {
								"visibility" : "off"
							} ]
						}, {
							"featureType" : "road",
							"elementType" : "labels",
							"stylers" : [ {
								"visibility" : "off"
							} ]
						}, {
							"featureType" : "transit",
							"stylers" : [ {
								"visibility" : "off"
							} ]
						}, {
							"featureType" : "administrative.country",
							"elementType" : "all",
							"stylers" : [ {
								"visibility" : "simplified"
							} ]
						}, {
							"featureType" : "administrative.province",
							"elementType" : "all",
							"stylers" : [ {
								"visibility" : "simplified"
							} ]
						}, {
							"featureType" : "administrative.locality",
							"elementType" : "all",
							"stylers" : [ {
								"visibility" : "off"
							} ]
						}, {
							"featureType" : "administrative.neighborhood",
							"elementType" : "all",
							"stylers" : [ {
								"visibility" : "off"
							} ]
						}, {
							"featureType" : "administrative.land_parcel",
							"elementType" : "all",
							"stylers" : [ {
								"visibility" : "off"
							} ]
						} ]

					};

					map = new google.maps.Map(document
							.getElementById('map-canvas'), mapOptions);
					for (var i = 0; i < pointArray.length; i++) {
						// Create a lat/long object readable by Google

						var marker = new google.maps.Marker({
							position : new google.maps.LatLng(
									parseFloat(pointArray[i][1]),
									parseFloat(pointArray[i][2])),
							map : map,
							title : "IP : "
									+ pointArray[i][0]
									+ "</br>"
									+ "Location : "
									+ getAddress(pointArray[i][1],
											pointArray[i][2])
						});
						(function(marker, i) {
							// add click event
							google.maps.event
									.addListener(
											marker,
											'click',
											function() {
												infowindow = new google.maps.InfoWindow(
														{
															content : marker.title
														});
												infowindow.open(map, marker);
											});
						})(marker, i);
						taxiData.push(marker);
					}
					var markerCluster = new MarkerClusterer(map, taxiData);

				}

				function loadMap() {
					/* google.maps.event.addDomListener(window, 'load', initialize); */
					initialize();
				}
			</script>
			<div id="scatter" class="centerDiv"></div>
			<script src="javascripts/punchcard.js"></script>

			<div id="containerHigh"
				style="width: 800px; height: 400px; margin: 0 auto"></div>
			<div id="container3D"
				style="width: 800px; height: 400px; margin: 0 auto"></div>
			<script type="text/javascript">
				$(function() {
					var chart;
					$(document)
							.ready(
									function() {

										var colors = Highcharts.getOptions().colors, categories = [
												'192.168.0.1', '192.168.0.2',
												'192.168.0.3', '192.168.0.4',
												'192.168.0.5' ], name = 'Source IP', data = [
												{
													y : 291,
													color : colors[0],
													drilldown : {
														name : '192.168.0.1',
														categories : [ '80',
																'443', '5050',
																'1755' ],
														data : [ 26, 91, 46,
																128 ],
														color : colors[0]
													}
												},
												{
													y : 494,
													color : colors[1],
													drilldown : {
														name : '192.168.0.2',
														categories : [ '80',
																'443', '5050',
																'1755' ],
														data : [ 48, 75, 148,
																223 ],
														color : colors[1]
													}
												},
												{
													y : 188,
													color : colors[2],
													drilldown : {
														name : '192.168.0.3',
														categories : [ '80',
																'443', '5050',
																'1755' ],
														data : [ 98, 12, 55, 23 ],
														color : colors[2]
													}
												},
												{
													y : 1379,
													color : colors[3],
													drilldown : {
														name : '192.168.0.4',
														categories : [ '80',
																'443', '5050',
																'1755' ],
														data : [ 128, 248, 547,
																456 ],
														color : colors[3]
													}
												},
												{
													y : 578,
													color : colors[4],
													drilldown : {
														name : '192.168.0.5',
														categories : [ '80',
																'443', '5050',
																'1755' ],
														data : [ 147, 128, 178,
																125 ],
														color : colors[4]
													}
												} ];

										function setChart(name, categories,
												data, color) {
											chart.xAxis[0].setCategories(
													categories, false);
											chart.series[0].remove(false);
											chart.addSeries({
												name : name,
												data : data,
											}, false);
											chart.redraw();
										}

										chart = new Highcharts.Chart(
												{
													chart : {
														renderTo : 'containerHigh',
														type : 'line'
													},
													title : {
														text : 'Ip Traffic Analysis'
													},
													legend : {
														enabled : false
													},
													xAxis : {
														categories : categories
													},
													yAxis : {
														title : {
															text : 'Count'
														}
													},
													plotOptions : {
														line : {
															cursor : 'pointer',
															point : {
																events : {
																	click : function() {
																		var drilldown = this.drilldown;
																		if (drilldown) { // drill down
																			setChart(
																					drilldown.name,
																					drilldown.categories,
																					drilldown.data,
																					drilldown.color);
																		} else { // restore
																			setChart(
																					name,
																					categories,
																					data);
																		}
																	}
																}
															},
															dataLabels : {
																enabled : true,
																color : colors[1],/* ,
																																                        style: {
																																                            fontWeight: 'bold'
																																                        }, */
																formatter : function() {
																	return this.y
																			+ ' Packets';
																}
															}
														}
													},
													tooltip : {
														formatter : function() {
															var point = this.point, s = this.x
																	+ ':<b>'
																	+ this.y
																	+ ' packets';
															if (point.drilldown) {
																s += '<br>Click to view '
																		+ point.category
																		+ ' detailed port details';
															} else {
																s += '<br>Click to return to IP Address';
															}
															return s;
														}
													},
													series : [ {
														name : name,
														data : data
													} ],
													exporting : {
														enabled : false
													}
												});
									});

					$(function() {

						// Give the points a 3D feel by adding a radial gradient
						Highcharts.getOptions().colors = $.map(Highcharts
								.getOptions().colors, function(color) {
							return {
								radialGradient : {
									cx : 0.4,
									cy : 0.3,
									r : 0.5
								},
								stops : [
										[ 0, color ],
										[
												1,
												Highcharts.Color(color)
														.brighten(-0.2).get(
																'rgb') ] ]
							};
						});

						// Set up the chart
						var chart = new Highcharts.Chart({
							chart : {
								renderTo : 'container3D',
								margin : 100,
								type : 'scatter',
								options3d : {
									enabled : true,
									alpha : 10,
									beta : 30,
									depth : 250,
									viewDistance : 5,

									frame : {
										bottom : {
											size : 1,
											color : 'rgba(0,0,0,0.02)'
										},
										back : {
											size : 1,
											color : 'rgba(0,0,0,0.04)'
										},
										side : {
											size : 1,
											color : 'rgba(0,0,0,0.06)'
										}
									}
								}
							},
							title : {
								text : '3D Scatter plot for IP, Date, Count'
							},
							plotOptions : {
								scatter : {
									width : 10,
									height : 10,
									depth : 10
								}
							},
							yAxis : {
								min : 0,
								max : 10,
								title : null
							},
							xAxis : {
								min : 0,
								max : 10,
								gridLineWidth : 1
							},
							zAxis : {
								min : 0,
								max : 10
							},
							legend : {
								enabled : false
							},
							series : [ {
								name : 'Count',
								colorByPoint : true,
								data : [ [ 1, 6, 5 ], [ 8, 7, 9 ], [ 1, 3, 4 ],
										[ 4, 6, 8 ], [ 5, 7, 7 ], [ 6, 9, 6 ],
										[ 7, 0, 5 ], [ 2, 3, 3 ], [ 3, 9, 8 ],
										[ 3, 6, 5 ], [ 4, 9, 4 ], [ 2, 3, 3 ],
										[ 6, 9, 9 ], [ 0, 7, 0 ], [ 7, 7, 9 ],
										[ 7, 2, 9 ], [ 0, 6, 2 ], [ 4, 6, 7 ],
										[ 3, 7, 7 ], [ 0, 1, 7 ], [ 2, 8, 6 ],
										[ 2, 3, 7 ], [ 6, 4, 8 ], [ 3, 5, 9 ],
										[ 7, 9, 5 ], [ 3, 1, 7 ], [ 4, 4, 2 ],
										[ 3, 6, 2 ], [ 3, 1, 6 ], [ 6, 8, 5 ],
										[ 6, 6, 7 ], [ 4, 1, 1 ], [ 7, 2, 7 ],
										[ 7, 7, 0 ], [ 8, 8, 9 ], [ 9, 4, 1 ],
										[ 8, 3, 4 ], [ 9, 8, 9 ], [ 3, 5, 3 ],
										[ 0, 2, 4 ], [ 6, 0, 2 ], [ 2, 1, 3 ],
										[ 5, 8, 9 ], [ 2, 1, 1 ], [ 9, 7, 6 ],
										[ 3, 0, 2 ], [ 9, 9, 0 ], [ 3, 4, 8 ],
										[ 2, 6, 1 ], [ 8, 9, 2 ], [ 7, 6, 5 ],
										[ 6, 3, 1 ], [ 9, 3, 1 ], [ 8, 9, 3 ],
										[ 9, 1, 0 ], [ 3, 8, 7 ], [ 8, 0, 0 ],
										[ 4, 9, 7 ], [ 8, 6, 2 ], [ 4, 3, 0 ],
										[ 2, 3, 5 ], [ 9, 1, 4 ], [ 1, 1, 4 ],
										[ 6, 0, 2 ], [ 6, 1, 6 ], [ 3, 8, 8 ],
										[ 8, 8, 7 ], [ 5, 5, 0 ], [ 3, 9, 6 ],
										[ 5, 4, 3 ], [ 6, 8, 3 ], [ 0, 1, 5 ],
										[ 6, 7, 3 ], [ 8, 3, 2 ], [ 3, 8, 3 ],
										[ 2, 1, 6 ], [ 4, 6, 7 ], [ 8, 9, 9 ],
										[ 5, 4, 2 ], [ 6, 1, 3 ], [ 6, 9, 5 ],
										[ 4, 8, 2 ], [ 9, 7, 4 ], [ 5, 4, 2 ],
										[ 9, 6, 1 ], [ 2, 7, 3 ], [ 4, 5, 4 ],
										[ 6, 8, 1 ], [ 3, 4, 0 ], [ 2, 2, 6 ],
										[ 5, 1, 2 ], [ 9, 9, 7 ], [ 6, 9, 9 ],
										[ 8, 4, 3 ], [ 4, 1, 7 ], [ 6, 2, 5 ],
										[ 0, 4, 9 ], [ 3, 5, 9 ], [ 6, 9, 1 ],
										[ 1, 9, 2 ] ]
							} ]
						});

						// Add mouse events for rotation
						$(chart.container)
								.bind(
										'mousedown.hc touchstart.hc',
										function(e) {
											e = chart.pointer.normalize(e);

											var posX = e.pageX, posY = e.pageY, alpha = chart.options.chart.options3d.alpha, beta = chart.options.chart.options3d.beta, newAlpha, newBeta, sensitivity = 5; // lower is more sensitive

											$(document)
													.bind(
															{
																'mousemove.hc touchdrag.hc' : function(
																		e) {
																	// Run beta
																	newBeta = beta
																			+ (posX - e.pageX)
																			/ sensitivity;
																	newBeta = Math
																			.min(
																					100,
																					Math
																							.max(
																									-100,
																									newBeta));
																	chart.options.chart.options3d.beta = newBeta;

																	// Run alpha
																	newAlpha = alpha
																			+ (e.pageY - posY)
																			/ sensitivity;
																	newAlpha = Math
																			.min(
																					100,
																					Math
																							.max(
																									-100,
																									newAlpha));
																	chart.options.chart.options3d.alpha = newAlpha;

																	chart
																			.redraw(false);
																},
																'mouseup touchend' : function() {
																	$(document)
																			.unbind(
																					'.hc');
																}
															});
										});

					});

				});
			</script>
		</section>
	</div>

	<!-- FOOTER  -->
	<div id="footer_wrap" class="outer">
		<footer class="inner">
			<p class="copyright">
				Cse523 maintained by <a href="https://github.com/nikhilambekar">nikhilambekar</a>
			</p>
			<p>
				Published with <a href="https://pages.github.com">GitHub Pages</a>
			</p>
		</footer>
	</div>



</body>
</html>
